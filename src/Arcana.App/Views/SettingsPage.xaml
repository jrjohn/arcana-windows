<?xml version="1.0" encoding="utf-8"?>
<Page
    x:Class="Arcana.App.Views.SettingsPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    Background="{ThemeResource ApplicationPageBackgroundThemeBrush}">

    <ScrollViewer Padding="24">
        <StackPanel Spacing="24" MaxWidth="800" HorizontalAlignment="Left">
            <TextBlock x:Name="PageTitle" Style="{StaticResource TitleTextBlockStyle}"/>

            <!-- Appearance -->
            <Border Style="{StaticResource CardStyle}">
                <StackPanel Spacing="16">
                    <TextBlock x:Name="AppearanceTitle" Style="{StaticResource SubtitleTextBlockStyle}"/>

                    <!-- Theme Selection -->
                    <TextBlock x:Name="ThemeLabel" Style="{StaticResource BodyStrongTextBlockStyle}"/>
                    <GridView x:Name="ThemeGridView"
                              SelectionMode="Single"
                              SelectionChanged="ThemeGridView_SelectionChanged"
                              ItemsSource="{x:Bind ThemeItems}">
                        <GridView.ItemTemplate>
                            <DataTemplate>
                                <Border Width="120" Height="80" CornerRadius="8"
                                        BorderBrush="{ThemeResource ControlStrokeColorDefaultBrush}"
                                        BorderThickness="2"
                                        Margin="4">
                                    <Grid>
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="*"/>
                                            <RowDefinition Height="Auto"/>
                                        </Grid.RowDefinitions>
                                        <!-- Theme Preview -->
                                        <Grid Grid.Row="0" CornerRadius="6,6,0,0">
                                            <Grid.Background>
                                                <SolidColorBrush Color="{Binding BackgroundColor}"/>
                                            </Grid.Background>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="30"/>
                                                <ColumnDefinition Width="*"/>
                                            </Grid.ColumnDefinitions>
                                            <!-- Sidebar Preview -->
                                            <Border Grid.Column="0" CornerRadius="6,0,0,0">
                                                <Border.Background>
                                                    <SolidColorBrush Color="{Binding PaneColor}"/>
                                                </Border.Background>
                                            </Border>
                                            <!-- Content Area -->
                                            <StackPanel Grid.Column="1" Padding="4" Spacing="2">
                                                <Border Height="4" Width="40" CornerRadius="2" HorizontalAlignment="Left">
                                                    <Border.Background>
                                                        <SolidColorBrush Color="{Binding AccentColor}"/>
                                                    </Border.Background>
                                                </Border>
                                                <Border Height="3" Width="30" CornerRadius="1" HorizontalAlignment="Left" Opacity="0.5">
                                                    <Border.Background>
                                                        <SolidColorBrush Color="{Binding TextColor}"/>
                                                    </Border.Background>
                                                </Border>
                                            </StackPanel>
                                        </Grid>
                                        <!-- Theme Name -->
                                        <Border Grid.Row="1"
                                                Background="{ThemeResource CardBackgroundFillColorSecondaryBrush}"
                                                CornerRadius="0,0,6,6"
                                                Padding="4,2">
                                            <TextBlock Text="{Binding DisplayName}"
                                                       FontSize="11"
                                                       HorizontalAlignment="Center"
                                                       TextTrimming="CharacterEllipsis"/>
                                        </Border>
                                    </Grid>
                                </Border>
                            </DataTemplate>
                        </GridView.ItemTemplate>
                    </GridView>

                    <ComboBox x:Name="LanguageComboBox" Width="200" SelectionChanged="LanguageComboBox_SelectionChanged">
                        <ComboBoxItem x:Name="LangZhTW" Tag="zh-TW"/>
                        <ComboBoxItem Content="English" Tag="en-US"/>
                        <ComboBoxItem x:Name="LangJaJP" Tag="ja-JP"/>
                    </ComboBox>
                </StackPanel>
            </Border>

            <!-- Sync Settings -->
            <Border Style="{StaticResource CardStyle}">
                <StackPanel Spacing="16">
                    <TextBlock x:Name="SyncTitle" Style="{StaticResource SubtitleTextBlockStyle}"/>

                    <ToggleSwitch x:Name="AutoSyncToggle" IsOn="True" Toggled="AutoSyncToggle_Toggled"/>

                    <ComboBox x:Name="SyncFrequencyComboBox" Width="200" SelectionChanged="SyncFrequencyComboBox_SelectionChanged">
                        <ComboBoxItem x:Name="Freq5Min" IsSelected="True"/>
                        <ComboBoxItem x:Name="Freq15Min"/>
                        <ComboBoxItem x:Name="Freq30Min"/>
                        <ComboBoxItem x:Name="FreqHour"/>
                    </ComboBox>

                    <Button x:Name="SyncNowButton" Click="SyncNow_Click"/>
                </StackPanel>
            </Border>

            <!-- Data Settings -->
            <Border Style="{StaticResource CardStyle}">
                <StackPanel Spacing="16">
                    <TextBlock x:Name="DataTitle" Style="{StaticResource SubtitleTextBlockStyle}"/>

                    <Button x:Name="ExportButton" Click="Export_Click"/>
                    <Button x:Name="ImportButton" Click="Import_Click"/>
                    <Button x:Name="ClearCacheButton" Click="ClearCache_Click"/>
                </StackPanel>
            </Border>

            <!-- About -->
            <Border Style="{StaticResource CardStyle}">
                <StackPanel Spacing="8">
                    <TextBlock x:Name="AboutTitle" Style="{StaticResource SubtitleTextBlockStyle}"/>
                    <TextBlock x:Name="AppName"/>
                    <TextBlock x:Name="AppVersion" Opacity="0.7"/>
                    <TextBlock Text="Â© 2024 Arcana Team" Opacity="0.7"/>
                </StackPanel>
            </Border>
        </StackPanel>
    </ScrollViewer>
</Page>
